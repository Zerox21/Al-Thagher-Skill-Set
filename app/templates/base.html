 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/app/templates/base.html b/app/templates/base.html
index ce6e2d40943ab57496db7d2f4b5bb1d7bdf70af1..cdd5f64824de089a4f6b036bd8f8c8879d7dd39d 100644
--- a/app/templates/base.html
+++ b/app/templates/base.html
@@ -1,44 +1,92 @@
 <!doctype html>
-<html lang="en">
+<html lang="{{ app_locale or 'ar' }}" dir="{{ app_text_dir or 'rtl' }}">
 <head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
-  <title>{{ title or brand.name }}</title>
-  <link rel="icon" href="{{ brand.favicon_path }}">
+  {% set brand_name = brand.name if brand is defined and brand.name else 'App' %}
+  {% set brand_tagline = brand.tagline if brand is defined and brand.tagline else '' %}
+  {% set brand_logo = brand.logo_path if brand is defined and brand.logo_path else '' %}
+  {% set brand_favicon = brand.favicon_path if brand is defined and brand.favicon_path else '' %}
+  {% set brand_primary = brand.primary_color if brand is defined and brand.primary_color else '' %}
+
+  <title>{{ title or brand_name }}</title>
+  {% if brand_favicon %}
+    <link rel="icon" href="{{ brand_favicon }}">
+  {% endif %}
   <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
-  <style>:root{--primary: {{ brand.primary_color }};}</style>
+  {% if brand_primary %}
+    <style>:root{--primary: {{ brand_primary }};}</style>
+  {% endif %}
 </head>
 <body>
   <header class="top">
     <div class="container top-inner">
-      <div class="brand"><img class="brand-logo" src="{{ brand.logo_path }}" alt="logo" onerror="this.style.display='none'"> <span class="brand-text">{{ brand.name }}</span></div>
+      <div class="brand">
+        {% if brand_logo %}
+          <img class="brand-logo" src="{{ brand_logo }}" alt="logo" onerror="this.style.display='none'">
+        {% endif %}
+        <span class="brand-text">{{ brand_name }}</span>
+      </div>
       <nav class="nav">
         {% if current_user.is_authenticated %}
+          <div class="menu">
+            {% if current_user.role == 'student' %}
+              <a class="menu-link" href="{{ url_for('student.dashboard') }}">لوحة الطالب <span class="en">Student</span></a>
+            {% elif current_user.role == 'teacher' %}
+              <a class="menu-link" href="{{ url_for('teacher.dashboard') }}">لوحة المعلم <span class="en">Teacher</span></a>
+              <a class="menu-link" href="{{ url_for('teacher.reports') }}">التقارير <span class="en">Reports</span></a>
+              <a class="menu-link" href="{{ url_for('teacher.question_tool') }}">الأسئلة <span class="en">Questions</span></a>
+            {% elif current_user.role == 'chairman' %}
+              <a class="menu-link" href="{{ url_for('chairman.dashboard') }}">لوحة الرئيس <span class="en">Chairman</span></a>
+              <a class="menu-link" href="{{ url_for('chairman.skills') }}">المهارات <span class="en">Skills</span></a>
+              <a class="menu-link" href="{{ url_for('chairman.users') }}">المستخدمون <span class="en">Users</span></a>
+            {% endif %}
+          </div>
           <span class="pill">{{ current_user.role }}: {{ current_user.name }} ({{ current_user.id }})</span>
           <a class="link" href="{{ url_for('auth.logout') }}">Logout</a>
         {% else %}
           <a class="link" href="{{ url_for('auth.login') }}">Login</a>
         {% endif %}
       </nav>
     </div>
   </header>
 
+  {% if current_user.is_authenticated %}
+    <div class="toplinks">
+      <div class="container toplinks-inner">
+        <a class="tab" href="{{ url_for('auth.home') }}">Home</a>
+        {% if current_user.role == 'student' %}
+          <span class="muted small">Student Panel</span>
+        {% elif current_user.role == 'teacher' %}
+          <span class="muted small">Teacher Panel</span>
+        {% elif current_user.role == 'chairman' %}
+          <span class="muted small">Chairman Panel</span>
+        {% endif %}
+      </div>
+    </div>
+  {% endif %}
+
   <main class="container">
     {% with messages = get_flashed_messages(with_categories=True) %}
       {% if messages %}
         <div class="flash-wrap">
           {% for cat,msg in messages %}
             <div class="flash {{ cat }}">{{ msg }}</div>
           {% endfor %}
         </div>
       {% endif %}
     {% endwith %}
 
     {% block content %}{% endblock %}
   </main>
 
   <footer class="footer">
-    <div class="container small">{{ brand.tagline }}</div>
+    <div class="container small">
+      {% if brand_tagline %}
+        {{ brand_tagline }} —
+      {% endif %}
+      <span class="muted small">APP_VERSION={{ app_version or 'dev' }}</span>
+    </div>
   </footer>
 </body>
 </html>
 
EOF
)
