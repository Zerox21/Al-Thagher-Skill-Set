{% extends "base.html" %}
{% block content %}
<h1 class="h1">لوحة الطالب</h1>

<div class="card">
  <h2 class="h2">المهارات المتاحة</h2>
  {% if not skills %}
    <p class="muted">لا توجد مهارات مفتوحة لك حالياً.</p>
  {% else %}
    <table class="table">
      <tr><th>المهارة</th><th>الوقت</th><th>النجاح</th><th></th></tr>
      {% for s in skills %}
        <tr>
          <td>{{ s.name_ar }}</td>
          <td>{{ s.time_limit_min }} دقيقة</td>
          <td>{{ s.pass_threshold }}%</td>
          <td><a class="btn small" href="{{ url_for('student.start', skill_id=s.id) }}">{{ t('start_test') }}</a></td>
        </tr>
      {% endfor %}
    </table>
  {% endif %}
</div>

<div class="grid2">
  <div class="card">
    <h2 class="h2">المحاولات</h2>
    {% if not attempts %}
      <p class="muted">لا توجد محاولات بعد.</p>
    {% else %}
      <table class="table">
        <tr><th>ID</th><th>الأسبوع</th><th>النتيجة</th><th></th></tr>
        {% for a in attempts %}
          <tr>
            <td>{{ a.id }}</td>
            <td>{{ a.week_key }}</td>
            <td>{{ a.score }}%</td>
            <td><a class="link" href="{{ url_for('student.attempt_result', attempt_id=a.id) }}">عرض</a></td>
          </tr>
        {% endfor %}
      </table>
    {% endif %}
  </div>

  <div class="card">
    <h2 class="h2">{{ t('remediation') }}</h2>
    {% if not remediations %}
      <p class="muted">لا يوجد ملفات علاجية.</p>
    {% else %}
      <ul>
        {% for r in remediations %}
          <li>
            مهارة #{{ r.skill_id }} — <a class="link" href="{{ url_for('media.file', media_id=r.file_media_id) }}">{{ t('download') }}</a>
            {% if r.notes_ar %}<div class="muted small">{{ r.notes_ar }}</div>{% endif %}
          </li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>
</div>
{% endblock %}
